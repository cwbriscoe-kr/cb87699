--------------------------------------------------------
--  DDL for View STAGE_V_CHOICE
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "AAM"."STAGE_V_CHOICE" ("LOCATION_ID", "DEPT_NBR", "SUBDEPT_NBR", "CLASS_NBR", "ITEM_GROUP_NBR", "SUBCLASS_NBR", "CHOICE_NBR", "STR_ON_ORDER", "DNF_INTRANSIT", "WTD_SALES", "ON_HAND_CURR", "ON_HAND_01AGO", "ON_HAND_02AGO", "ON_HAND_03AGO", "ON_HAND_04AGO", "ON_HAND_05AGO", "ON_HAND_06AGO", "ON_HAND_07AGO", "ON_HAND_08AGO", "ON_HAND_09AGO", "ON_HAND_10AGO", "ON_HAND_11AGO", "ON_HAND_12AGO", "ON_HAND_13AGO", "ON_HAND_14AGO", "ON_HAND_15AGO", "ON_HAND_16AGO", "ON_HAND_17AGO", "ON_HAND_18AGO", "ON_HAND_19AGO", "ON_HAND_20AGO", "ON_HAND_21AGO", "ON_HAND_22AGO", "ON_HAND_23AGO", "ON_HAND_24AGO", "ON_HAND_25AGO", "ON_HAND_26AGO", "ON_HAND_27AGO", "ON_HAND_28AGO", "ON_HAND_29AGO", "ON_HAND_30AGO", "ON_HAND_31AGO", "ON_HAND_32AGO", "ON_HAND_33AGO", "ON_HAND_34AGO", "ON_HAND_35AGO", "ON_HAND_36AGO", "ON_HAND_37AGO", "ON_HAND_38AGO", "ON_HAND_39AGO", "ON_HAND_40AGO", "ON_HAND_41AGO", "ON_HAND_42AGO", "ON_HAND_43AGO", "ON_HAND_44AGO", "ON_HAND_45AGO", "ON_HAND_46AGO", "ON_HAND_47AGO", "ON_HAND_48AGO", "ON_HAND_49AGO", "ON_HAND_50AGO", "ON_HAND_51AGO", "ON_HAND_52AGO", "ON_HAND_53AGO", "ON_HAND_54AGO", "ON_HAND_55AGO", "ON_HAND_56AGO", "ON_HAND_57AGO", "ON_HAND_58AGO", "ON_HAND_59AGO", "ON_HAND_60AGO", "ON_HAND_61AGO", "ON_HAND_62AGO", "ON_HAND_63AGO", "ON_HAND_64AGO", "ON_HAND_65AGO", "ON_HAND_66AGO", "ON_HAND_67AGO", "ON_HAND_68AGO", "ON_HAND_69AGO", "ON_HAND_70AGO", "ON_HAND_71AGO", "ON_HAND_72AGO", "ON_HAND_73AGO", "ON_HAND_74AGO", "ON_HAND_75AGO", "ON_HAND_76AGO", "ON_HAND_77AGO", "ON_HAND_78AGO", "SLS_01AGO", "SLS_02AGO", "SLS_03AGO", "SLS_04AGO", "SLS_05AGO", "SLS_06AGO", "SLS_07AGO", "SLS_08AGO", "SLS_09AGO", "SLS_10AGO", "SLS_11AGO", "SLS_12AGO", "SLS_13AGO", "SLS_14AGO", "SLS_15AGO", "SLS_16AGO", "SLS_17AGO", "SLS_18AGO", "SLS_19AGO", "SLS_20AGO", "SLS_21AGO", "SLS_22AGO", "SLS_23AGO", "SLS_24AGO", "SLS_25AGO", "SLS_26AGO", "SLS_27AGO", "SLS_28AGO", "SLS_29AGO", "SLS_30AGO", "SLS_31AGO", "SLS_32AGO", "SLS_33AGO", "SLS_34AGO", "SLS_35AGO", "SLS_36AGO", "SLS_37AGO", "SLS_38AGO", "SLS_39AGO", "SLS_40AGO", "SLS_41AGO", "SLS_42AGO", "SLS_43AGO", "SLS_44AGO", "SLS_45AGO", "SLS_46AGO", "SLS_47AGO", "SLS_48AGO", "SLS_49AGO", "SLS_50AGO", "SLS_51AGO", "SLS_52AGO", "SLS_53AGO", "SLS_54AGO", "SLS_55AGO", "SLS_56AGO", "SLS_57AGO", "SLS_58AGO", "SLS_59AGO", "SLS_60AGO", "SLS_61AGO", "SLS_62AGO", "SLS_63AGO", "SLS_64AGO", "SLS_65AGO", "SLS_66AGO", "SLS_67AGO", "SLS_68AGO", "SLS_69AGO", "SLS_70AGO", "SLS_71AGO", "SLS_72AGO", "SLS_73AGO", "SLS_74AGO", "SLS_75AGO", "SLS_76AGO", "SLS_77AGO", "SLS_78AGO", "REG_SLS_WTD", "REG_SLS_01AGO", "REG_SLS_02AGO", "REG_SLS_03AGO", "REG_SLS_04AGO", "REG_SLS_05AGO", "REG_SLS_06AGO", "REG_SLS_07AGO", "REG_SLS_08AGO", "REG_SLS_09AGO", "REG_SLS_10AGO", "REG_SLS_11AGO", "REG_SLS_12AGO", "REG_SLS_13AGO", "REG_SLS_14AGO", "REG_SLS_15AGO", "REG_SLS_16AGO", "REG_SLS_17AGO", "REG_SLS_18AGO", "REG_SLS_19AGO", "REG_SLS_20AGO", "REG_SLS_21AGO", "REG_SLS_22AGO", "REG_SLS_23AGO", "REG_SLS_24AGO", "REG_SLS_25AGO", "REG_SLS_26AGO", "REG_SLS_27AGO", "REG_SLS_28AGO", "REG_SLS_29AGO", "REG_SLS_30AGO", "REG_SLS_31AGO", "REG_SLS_32AGO", "REG_SLS_33AGO", "REG_SLS_34AGO", "REG_SLS_35AGO", "REG_SLS_36AGO", "REG_SLS_37AGO", "REG_SLS_38AGO", "REG_SLS_39AGO", "REG_SLS_40AGO", "REG_SLS_41AGO", "REG_SLS_42AGO", "REG_SLS_43AGO", "REG_SLS_44AGO", "REG_SLS_45AGO", "REG_SLS_46AGO", "REG_SLS_47AGO", "REG_SLS_48AGO", "REG_SLS_49AGO", "REG_SLS_50AGO", "REG_SLS_51AGO", "REG_SLS_52AGO", "REG_SLS_53AGO", "REG_SLS_54AGO", "REG_SLS_55AGO", "REG_SLS_56AGO", "REG_SLS_57AGO", "REG_SLS_58AGO", "REG_SLS_59AGO", "REG_SLS_60AGO", "REG_SLS_61AGO", "REG_SLS_62AGO", "REG_SLS_63AGO", "REG_SLS_64AGO", "REG_SLS_65AGO", "REG_SLS_66AGO", "REG_SLS_67AGO", "REG_SLS_68AGO", "REG_SLS_69AGO", "REG_SLS_70AGO", "REG_SLS_71AGO", "REG_SLS_72AGO", "REG_SLS_73AGO", "REG_SLS_74AGO", "REG_SLS_75AGO", "REG_SLS_76AGO", "REG_SLS_77AGO", "REG_SLS_78AGO") AS 
  SELECT location_id,
         dept_nbr,
         subdept_nbr,
         class_nbr,
         item_group_nbr,
         subclass_nbr,
         choice_nbr,
         SUM (str_on_order) AS str_on_order,
         SUM (dnf_intransit) AS dnf_intransit,
         SUM (wtd_sales) AS wtd_sales,
         SUM (on_hand_curr) AS on_hand_curr,
         SUM (on_hand_01ago) AS on_hand_01ago,
         SUM (on_hand_02ago) AS on_hand_02ago,
         SUM (on_hand_03ago) AS on_hand_03ago,
         SUM (on_hand_04ago) AS on_hand_04ago,
         SUM (on_hand_05ago) AS on_hand_05ago,
         SUM (on_hand_06ago) AS on_hand_06ago,
         SUM (on_hand_07ago) AS on_hand_07ago,
         SUM (on_hand_08ago) AS on_hand_08ago,
         SUM (on_hand_09ago) AS on_hand_09ago,
         SUM (on_hand_10ago) AS on_hand_10ago,
         SUM (on_hand_11ago) AS on_hand_11ago,
         SUM (on_hand_12ago) AS on_hand_12ago,
         SUM (on_hand_13ago) AS on_hand_13ago,
         SUM (on_hand_14ago) AS on_hand_14ago,
         SUM (on_hand_15ago) AS on_hand_15ago,
         SUM (on_hand_16ago) AS on_hand_16ago,
         SUM (on_hand_17ago) AS on_hand_17ago,
         SUM (on_hand_18ago) AS on_hand_18ago,
         SUM (on_hand_19ago) AS on_hand_19ago,
         SUM (on_hand_20ago) AS on_hand_20ago,
         SUM (on_hand_21ago) AS on_hand_21ago,
         SUM (on_hand_22ago) AS on_hand_22ago,
         SUM (on_hand_23ago) AS on_hand_23ago,
         SUM (on_hand_24ago) AS on_hand_24ago,
         SUM (on_hand_25ago) AS on_hand_25ago,
         SUM (on_hand_26ago) AS on_hand_26ago,
         SUM (on_hand_27ago) AS on_hand_27ago,
         SUM (on_hand_28ago) AS on_hand_28ago,
         SUM (on_hand_29ago) AS on_hand_29ago,
         SUM (on_hand_30ago) AS on_hand_30ago,
         SUM (on_hand_31ago) AS on_hand_31ago,
         SUM (on_hand_32ago) AS on_hand_32ago,
         SUM (on_hand_33ago) AS on_hand_33ago,
         SUM (on_hand_34ago) AS on_hand_34ago,
         SUM (on_hand_35ago) AS on_hand_35ago,
         SUM (on_hand_36ago) AS on_hand_36ago,
         SUM (on_hand_37ago) AS on_hand_37ago,
         SUM (on_hand_38ago) AS on_hand_38ago,
         SUM (on_hand_39ago) AS on_hand_39ago,
         SUM (on_hand_40ago) AS on_hand_40ago,
         SUM (on_hand_41ago) AS on_hand_41ago,
         SUM (on_hand_42ago) AS on_hand_42ago,
         SUM (on_hand_43ago) AS on_hand_43ago,
         SUM (on_hand_44ago) AS on_hand_44ago,
         SUM (on_hand_45ago) AS on_hand_45ago,
         SUM (on_hand_46ago) AS on_hand_46ago,
         SUM (on_hand_47ago) AS on_hand_47ago,
         SUM (on_hand_48ago) AS on_hand_48ago,
         SUM (on_hand_49ago) AS on_hand_49ago,
         SUM (on_hand_50ago) AS on_hand_50ago,
         SUM (on_hand_51ago) AS on_hand_51ago,
         SUM (on_hand_52ago) AS on_hand_52ago,
         SUM (on_hand_53ago) AS on_hand_53ago,
         SUM (on_hand_54ago) AS on_hand_54ago,
         SUM (on_hand_55ago) AS on_hand_55ago,
         SUM (on_hand_56ago) AS on_hand_56ago,
         SUM (on_hand_57ago) AS on_hand_57ago,
         SUM (on_hand_58ago) AS on_hand_58ago,
         SUM (on_hand_59ago) AS on_hand_59ago,
         SUM (on_hand_60ago) AS on_hand_60ago,
         SUM (on_hand_61ago) AS on_hand_61ago,
         SUM (on_hand_62ago) AS on_hand_62ago,
         SUM (on_hand_63ago) AS on_hand_63ago,
         SUM (on_hand_64ago) AS on_hand_64ago,
         SUM (on_hand_65ago) AS on_hand_65ago,
         SUM (on_hand_66ago) AS on_hand_66ago,
         SUM (on_hand_67ago) AS on_hand_67ago,
         SUM (on_hand_68ago) AS on_hand_68ago,
         SUM (on_hand_69ago) AS on_hand_69ago,
         SUM (on_hand_70ago) AS on_hand_70ago,
         SUM (on_hand_71ago) AS on_hand_71ago,
         SUM (on_hand_72ago) AS on_hand_72ago,
         SUM (on_hand_73ago) AS on_hand_73ago,
         SUM (on_hand_74ago) AS on_hand_74ago,
         SUM (on_hand_75ago) AS on_hand_75ago,
         SUM (on_hand_76ago) AS on_hand_76ago,
         SUM (on_hand_77ago) AS on_hand_77ago,
         SUM (on_hand_78ago) AS on_hand_78ago,
         SUM (sls_01ago) AS sls_01ago,
         SUM (sls_02ago) AS sls_02ago,
         SUM (sls_03ago) AS sls_03ago,
         SUM (sls_04ago) AS sls_04ago,
         SUM (sls_05ago) AS sls_05ago,
         SUM (sls_06ago) AS sls_06ago,
         SUM (sls_07ago) AS sls_07ago,
         SUM (sls_08ago) AS sls_08ago,
         SUM (sls_09ago) AS sls_09ago,
         SUM (sls_10ago) AS sls_10ago,
         SUM (sls_11ago) AS sls_11ago,
         SUM (sls_12ago) AS sls_12ago,
         SUM (sls_13ago) AS sls_13ago,
         SUM (sls_14ago) AS sls_14ago,
         SUM (sls_15ago) AS sls_15ago,
         SUM (sls_16ago) AS sls_16ago,
         SUM (sls_17ago) AS sls_17ago,
         SUM (sls_18ago) AS sls_18ago,
         SUM (sls_19ago) AS sls_19ago,
         SUM (sls_20ago) AS sls_20ago,
         SUM (sls_21ago) AS sls_21ago,
         SUM (sls_22ago) AS sls_22ago,
         SUM (sls_23ago) AS sls_23ago,
         SUM (sls_24ago) AS sls_24ago,
         SUM (sls_25ago) AS sls_25ago,
         SUM (sls_26ago) AS sls_26ago,
         SUM (sls_27ago) AS sls_27ago,
         SUM (sls_28ago) AS sls_28ago,
         SUM (sls_29ago) AS sls_29ago,
         SUM (sls_30ago) AS sls_30ago,
         SUM (sls_31ago) AS sls_31ago,
         SUM (sls_32ago) AS sls_32ago,
         SUM (sls_33ago) AS sls_33ago,
         SUM (sls_34ago) AS sls_34ago,
         SUM (sls_35ago) AS sls_35ago,
         SUM (sls_36ago) AS sls_36ago,
         SUM (sls_37ago) AS sls_37ago,
         SUM (sls_38ago) AS sls_38ago,
         SUM (sls_39ago) AS sls_39ago,
         SUM (sls_40ago) AS sls_40ago,
         SUM (sls_41ago) AS sls_41ago,
         SUM (sls_42ago) AS sls_42ago,
         SUM (sls_43ago) AS sls_43ago,
         SUM (sls_44ago) AS sls_44ago,
         SUM (sls_45ago) AS sls_45ago,
         SUM (sls_46ago) AS sls_46ago,
         SUM (sls_47ago) AS sls_47ago,
         SUM (sls_48ago) AS sls_48ago,
         SUM (sls_49ago) AS sls_49ago,
         SUM (sls_50ago) AS sls_50ago,
         SUM (sls_51ago) AS sls_51ago,
         SUM (sls_52ago) AS sls_52ago,
         SUM (sls_53ago) AS sls_53ago,
         SUM (sls_54ago) AS sls_54ago,
         SUM (sls_55ago) AS sls_55ago,
         SUM (sls_56ago) AS sls_56ago,
         SUM (sls_57ago) AS sls_57ago,
         SUM (sls_58ago) AS sls_58ago,
         SUM (sls_59ago) AS sls_59ago,
         SUM (sls_60ago) AS sls_60ago,
         SUM (sls_61ago) AS sls_61ago,
         SUM (sls_62ago) AS sls_62ago,
         SUM (sls_63ago) AS sls_63ago,
         SUM (sls_64ago) AS sls_64ago,
         SUM (sls_65ago) AS sls_65ago,
         SUM (sls_66ago) AS sls_66ago,
         SUM (sls_67ago) AS sls_67ago,
         SUM (sls_68ago) AS sls_68ago,
         SUM (sls_69ago) AS sls_69ago,
         SUM (sls_70ago) AS sls_70ago,
         SUM (sls_71ago) AS sls_71ago,
         SUM (sls_72ago) AS sls_72ago,
         SUM (sls_73ago) AS sls_73ago,
         SUM (sls_74ago) AS sls_74ago,
         SUM (sls_75ago) AS sls_75ago,
         SUM (sls_76ago) AS sls_76ago,
         SUM (sls_77ago) AS sls_77ago,
         SUM (sls_78ago) AS sls_78ago,
		 SUM (reg_sls_wtd) AS reg_sls_wtd, 
		 SUM (reg_sls_01ago) AS reg_sls_01ago,
		 SUM (reg_sls_02ago) AS reg_sls_02ago, 
		 SUM (reg_sls_03ago) AS reg_sls_03ago, 
		 SUM (reg_sls_04ago) AS reg_sls_04ago, 
		 SUM (reg_sls_05ago) AS reg_sls_05ago, 
		 SUM (reg_sls_06ago) AS reg_sls_06ago,
		 SUM (reg_sls_07ago) AS reg_sls_07ago, 
		 SUM (reg_sls_08ago) AS reg_sls_08ago, 
		 SUM (reg_sls_09ago) AS reg_sls_09ago, 
		 SUM (reg_sls_10ago) AS reg_sls_10ago, 
		 SUM (reg_sls_11ago) AS reg_sls_11ago,
		 SUM (reg_sls_12ago) AS reg_sls_12ago, 
		 SUM (reg_sls_13ago) AS reg_sls_13ago, 
		 SUM (reg_sls_14ago) AS reg_sls_14ago, 
		 SUM (reg_sls_15ago) AS reg_sls_15ago, 
		 SUM (reg_sls_16ago) AS reg_sls_16ago,
		 SUM (reg_sls_17ago) AS reg_sls_17ago, 
		 SUM (reg_sls_18ago) AS reg_sls_18ago, 
		 SUM (reg_sls_19ago) AS reg_sls_19ago, 
		 SUM (reg_sls_20ago) AS reg_sls_20ago, 
		 SUM (reg_sls_21ago) AS reg_sls_21ago,
		 SUM (reg_sls_22ago) AS reg_sls_22ago, 
		 SUM (reg_sls_23ago) AS reg_sls_23ago, 
		 SUM (reg_sls_24ago) AS reg_sls_24ago, 
		 SUM (reg_sls_25ago) AS reg_sls_25ago, 
		 SUM (reg_sls_26ago) AS reg_sls_26ago,
		 SUM (reg_sls_27ago) AS reg_sls_27ago, 
		 SUM (reg_sls_28ago) AS reg_sls_28ago, 
		 SUM (reg_sls_29ago) AS reg_sls_29ago, 
		 SUM (reg_sls_30ago) AS reg_sls_30ago, 
		 SUM (reg_sls_31ago) AS reg_sls_31ago,
		 SUM (reg_sls_32ago) AS reg_sls_32ago, 
		 SUM (reg_sls_33ago) AS reg_sls_33ago, 
		 SUM (reg_sls_34ago) AS reg_sls_34ago, 
		 SUM (reg_sls_35ago) AS reg_sls_35ago, 
		 SUM (reg_sls_36ago) AS reg_sls_36ago,
		 SUM (reg_sls_37ago) AS reg_sls_37ago, 
		 SUM (reg_sls_38ago) AS reg_sls_38ago, 
		 SUM (reg_sls_39ago) AS reg_sls_39ago, 
		 SUM (reg_sls_40ago) AS reg_sls_40ago, 
		 SUM (reg_sls_41ago) AS reg_sls_41ago,
		 SUM (reg_sls_42ago) AS reg_sls_42ago, 
		 SUM (reg_sls_43ago) AS reg_sls_43ago, 
		 SUM (reg_sls_44ago) AS reg_sls_44ago, 
		 SUM (reg_sls_45ago) AS reg_sls_45ago, 
		 SUM (reg_sls_46ago) AS reg_sls_46ago,
		 SUM (reg_sls_47ago) AS reg_sls_47ago, 
		 SUM (reg_sls_48ago) AS reg_sls_48ago, 
		 SUM (reg_sls_49ago) AS reg_sls_49ago, 
		 SUM (reg_sls_50ago) AS reg_sls_50ago, 
		 SUM (reg_sls_51ago) AS reg_sls_51ago,
		 SUM (reg_sls_52ago) AS reg_sls_52ago, 
		 SUM (reg_sls_53ago) AS reg_sls_53ago, 
		 SUM (reg_sls_54ago) AS reg_sls_54ago, 
		 SUM (reg_sls_55ago) AS reg_sls_55ago, 
		 SUM (reg_sls_56ago) AS reg_sls_56ago,
		 SUM (reg_sls_57ago) AS reg_sls_57ago, 
		 SUM (reg_sls_58ago) AS reg_sls_58ago, 
		 SUM (reg_sls_59ago) AS reg_sls_59ago, 
		 SUM (reg_sls_60ago) AS reg_sls_60ago, 
		 SUM (reg_sls_61ago) AS reg_sls_61ago,
		 SUM (reg_sls_62ago) AS reg_sls_62ago, 
		 SUM (reg_sls_63ago) AS reg_sls_63ago, 
		 SUM (reg_sls_64ago) AS reg_sls_64ago, 
		 SUM (reg_sls_65ago) AS reg_sls_65ago, 
		 SUM (reg_sls_66ago) AS reg_sls_66ago,
		 SUM (reg_sls_67ago) AS reg_sls_67ago, 
		 SUM (reg_sls_68ago) AS reg_sls_68ago, 
		 SUM (reg_sls_69ago) AS reg_sls_69ago, 
		 SUM (reg_sls_70ago) AS reg_sls_70ago, 
		 SUM (reg_sls_71ago) AS reg_sls_71ago,
		 SUM (reg_sls_72ago) AS reg_sls_72ago, 
		 SUM (reg_sls_73ago) AS reg_sls_73ago, 
		 SUM (reg_sls_74ago) AS reg_sls_74ago, 
		 SUM (reg_sls_75ago) AS reg_sls_75ago, 
		 SUM (reg_sls_76ago) AS reg_sls_76ago,
		 SUM (reg_sls_77ago) AS reg_sls_77ago, 
		 SUM (reg_sls_78ago) AS reg_sls_78ago
    FROM stage_DIMENSION
GROUP BY dept_nbr,
         subdept_nbr,
         class_nbr,
         ITEM_GROUP_NBR,
         SUBCLASS_NBR,
         CHOICE_NBR,
         location_id
;
